"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],i=!0,a=!1,n=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw n}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,n=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw n}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}define(["loading","appRouter","layoutManager","connectionManager","userSettings","cardBuilder","datetime","mediaInfo","backdrop","listView","itemContextMenu","itemHelper","dom","indicators","imageLoader","libraryMenu","globalize","browser","events","playbackManager","scrollStyles","emby-itemscontainer","emby-checkbox","emby-button","emby-playstatebutton","emby-ratingbutton","emby-scroller","emby-select"],function(e,t,r,i,a,n,s,l,o,c,d,u,m,y,h,p,f,g,v,S){function I(e,t,r){var i,a=_createForOfIteratorHelper(e.querySelectorAll("."+t));try{for(a.s();!(i=a.n()).done;){var n=i.value;r?n.classList.remove("hide"):n.classList.add("hide")}}catch(e){a.e(e)}finally{a.f()}}function T(e,t,r){return{item:e,open:!1,play:!1,playAllFromHere:!1,queueAllFromHere:!1,positionTo:r,cancelTimer:!1,record:!1,deleteItem:!0===e.CanDelete,shuffle:!1,instantMix:!1,user:t,share:!0}}function b(e,t,r,i){var a=e.querySelector(".selectSource");if(!r.MediaSources||!u.supportsMediaSourceSelection(r)||-1===S.getSupportedCommands().indexOf("PlayMediaSource")||!S.canPlay(r))return e.querySelector(".trackSelections").classList.add("hide"),a.innerHTML="",e.querySelector(".selectVideo").innerHTML="",e.querySelector(".selectAudio").innerHTML="",void(e.querySelector(".selectSubtitles").innerHTML="");var n=r.MediaSources;t._currentPlaybackMediaSources=n,e.querySelector(".trackSelections").classList.remove("hide"),a.setLabel(f.translate("LabelVersion"));var s=a.value,l=n[0].Id;a.innerHTML=n.map(function(e){var t=e.Id===l?" selected":"";return'<option value="'+e.Id+'"'+t+">"+e.Name+"</option>"}).join(""),n.length>1?e.querySelector(".selectSourceContainer").classList.remove("hide"):e.querySelector(".selectSourceContainer").classList.add("hide"),(a.value!==s||i)&&(L(e,n),A(e,n),C(e,n))}function L(e,t){var r=e.querySelector(".selectSource").value,i=t.filter(function(e){return e.Id===r})[0].MediaStreams.filter(function(e){return"Video"===e.Type}),a=e.querySelector(".selectVideo");a.setLabel(f.translate("LabelVideo"));var n=i.length?i[0].Index:-1;a.innerHTML=i.map(function(e){var t=e.Index===n?" selected":"",r=[],i=l.getResolutionText(e);return i&&r.push(i),e.Codec&&r.push(e.Codec.toUpperCase()),'<option value="'+e.Index+'" '+t+">"+(e.DisplayTitle||r.join(" "))+"</option>"}).join(""),a.setAttribute("disabled","disabled"),i.length?e.querySelector(".selectVideoContainer").classList.remove("hide"):e.querySelector(".selectVideoContainer").classList.add("hide")}function A(e,t){var r=e.querySelector(".selectSource").value,i=t.filter(function(e){return e.Id===r})[0],a=i.MediaStreams.filter(function(e){return"Audio"===e.Type}),n=e.querySelector(".selectAudio");n.setLabel(f.translate("LabelAudio"));var s=i.DefaultAudioStreamIndex;n.innerHTML=a.map(function(e){var t=e.Index===s?" selected":"";return'<option value="'+e.Index+'" '+t+">"+e.DisplayTitle+"</option>"}).join(""),a.length>1?n.removeAttribute("disabled"):n.setAttribute("disabled","disabled"),a.length?e.querySelector(".selectAudioContainer").classList.remove("hide"):e.querySelector(".selectAudioContainer").classList.add("hide")}function C(e,t){var r=e.querySelector(".selectSource").value,i=t.filter(function(e){return e.Id===r})[0],a=i.MediaStreams.filter(function(e){return"Subtitle"===e.Type}),n=e.querySelector(".selectSubtitles");n.setLabel(f.translate("LabelSubtitles"));var s=null==i.DefaultSubtitleStreamIndex?-1:i.DefaultSubtitleStreamIndex;if(i.MediaStreams.filter(function(e){return"Video"===e.Type}).length){var l=-1===s?" selected":"";n.innerHTML='<option value="-1">'+f.translate("Off")+"</option>"+a.map(function(e){return l=e.Index===s?" selected":"",'<option value="'+e.Index+'" '+l+">"+e.DisplayTitle+"</option>"}).join(""),a.length>1?n.removeAttribute("disabled"):n.setAttribute("disabled","disabled"),e.querySelector(".selectSubtitlesContainer").classList.remove("hide")}else n.innerHTML="",e.querySelector(".selectSubtitlesContainer").classList.add("hide")}function M(e,t){var r=!1;if("Program"==t.Type){var i=new Date;i>=s.parseISO8601Date(t.StartDate,!0)&&i<s.parseISO8601Date(t.EndDate,!0)?(I(e,"btnPlay",!0),r=!0):I(e,"btnPlay"),I(e,"btnResume"),I(e,"btnInstantMix"),I(e,"btnShuffle")}else if(S.canPlay(t)){I(e,"btnPlay",!0),I(e,"btnInstantMix",-1!==["Audio","MusicAlbum","MusicGenre","MusicArtist"].indexOf(t.Type)),I(e,"btnShuffle",t.IsFolder||-1!==["MusicAlbum","MusicGenre","MusicArtist"].indexOf(t.Type)),r=!0;var a=t.UserData&&t.UserData.PlaybackPositionTicks>0;if(I(e,"btnResume",a),a){var n,l=_createForOfIteratorHelper(e.querySelectorAll(".btnPlay"));try{for(l.s();!(n=l.n()).done;)n.value.querySelector(".detailButton-icon").classList.replace("play_arrow","replay")}catch(e){l.e(e)}finally{l.f()}}}else I(e,"btnPlay"),I(e,"btnResume"),I(e,"btnInstantMix"),I(e,"btnShuffle");return r}function q(e,r,i){var a,n=[],s=_createForOfIteratorHelper(e);try{for(s.s();!(a=s.n()).done;){var l=a.value,o=t.getRouteUrl(l,{context:i,itemType:"MusicArtist",serverId:r});n.push('<a style="color:inherit;" class="button-link" is="emby-linkbutton" href="'+o+'">'+l.Name+"</a>")}}catch(e){s.e(e)}finally{s.f()}return n.join(" / ")}function P(e,t){(t.LocalTrailerCount||t.RemoteTrailers&&t.RemoteTrailers.length)&&-1!==S.getSupportedCommands().indexOf("PlayTrailers")?I(e,"btnPlayTrailer",!0):I(e,"btnPlayTrailer")}function H(l,y,p,g,v){var L=i.getApiClient(g.ServerId);Emby.Page.setTitle(""),function(e,t){!function(e,t,r){var i=[];i.push(t);var a=n.getCardsHtml(i,{shape:"auto",showTitle:!1,centerText:!0,overlayText:!1,transition:!1,disableIndicators:!0,disableHoverMenu:!0,overlayPlayButton:!0,width:.5*m.getWindowSize().innerWidth});e.innerHTML=a,r.lazyChildren(e)}(e.querySelector(".detailImageContainer"),t,h)}(y,g),function(e,t,i){var n=e.querySelector(".detailLogo"),s=function(e,t,r){return(r=r||{}).type="Logo",e.ImageTags&&e.ImageTags.Logo?(r.tag=e.ImageTags.Logo,t.getScaledImageUrl(e.Id,r)):e.ParentLogoImageTag?(r.tag=e.ParentLogoImageTag,t.getScaledImageUrl(e.ParentLogoItemId,r)):null}(t,i,{});(r.mobile||a.enableBackdrops())&&s?(n.classList.remove("hide"),h.setLazyImage(n,s)):n.classList.add("hide")}(y,g,L),function(e){m.getWindowSize().innerWidth>=1e3?o.setBackdrops([e]):o.clear()}(g),function(e,t,i){var n,s=!1,l=e.querySelector("#itemBackdrop");!(!r.mobile&&!a.detailsBanner())&&(t.BackdropImageTags&&t.BackdropImageTags.length?(n=i.getScaledImageUrl(t.Id,{type:"Backdrop",maxWidth:m.getScreenWidth(),index:0,tag:t.BackdropImageTags[0]}),h.lazyImage(l,n),s=!0):t.ParentBackdropItemId&&t.ParentBackdropImageTags&&t.ParentBackdropImageTags.length?(n=i.getScaledImageUrl(t.ParentBackdropItemId,{type:"Backdrop",maxWidth:m.getScreenWidth(),index:0,tag:t.ParentBackdropImageTags[0]}),h.lazyImage(l,n),s=!0):l.style.backgroundImage="")}(y,g,L),y.querySelector(".detailPagePrimaryContainer").classList.add("detailRibbon"),function(e,i,a){var n,s=[],l=!1;e.AlbumArtists?(s.push(q(e.AlbumArtists,e.ServerId,a)),l=!0):e.ArtistItems&&e.ArtistItems.length&&"MusicVideo"===e.Type?(s.push(q(e.ArtistItems,e.ServerId,a)),l=!0):e.SeriesName&&"Episode"===e.Type?(n=t.getRouteUrl({Id:e.SeriesId,Name:e.SeriesName,Type:"Series",IsFolder:!0,ServerId:e.ServerId},{context:a}),s.push('<a style="color:inherit;" class="button-link" is="emby-linkbutton" href="'+n+'">'+e.SeriesName+"</a>")):(e.IsSeries||e.EpisodeTitle)&&s.push(e.Name),e.SeriesName&&"Season"===e.Type?(n=t.getRouteUrl({Id:e.SeriesId,Name:e.SeriesName,Type:"Series",IsFolder:!0,ServerId:e.ServerId},{context:a}),s.push('<a style="color:inherit;" class="button-link" is="emby-linkbutton" href="'+n+'">'+e.SeriesName+"</a>")):null!=e.ParentIndexNumber&&"Episode"===e.Type?(n=t.getRouteUrl({Id:e.SeasonId,Name:e.SeasonName,Type:"Season",IsFolder:!0,ServerId:e.ServerId},{context:a}),s.push('<a style="color:inherit;" class="button-link" is="emby-linkbutton" href="'+n+'">'+e.SeasonName+"</a>")):null!=e.ParentIndexNumber&&e.IsSeries?s.push(e.SeasonName||"S"+e.ParentIndexNumber):e.Album&&e.AlbumId&&("MusicVideo"===e.Type||"Audio"===e.Type)?(n=t.getRouteUrl({Id:e.AlbumId,Name:e.Album,Type:"MusicAlbum",IsFolder:!0,ServerId:e.ServerId},{context:a}),s.push('<a style="color:inherit;" class="button-link" is="emby-linkbutton" href="'+n+'">'+e.Album+"</a>")):e.Album&&s.push(e.Album);var o="",c=s[0],d=s[1];s.length&&(o=l?r.mobile?'<h3 class="parentName musicParentName">'+s.join("</br>")+"</h3>":'<h3 class="parentName musicParentName">'+s.join(" - ")+"</h3>":'<h1 class="parentName">'+c+"</h1>");var m=u.getDisplayName(e,{includeParentInfo:!1});o&&!l?o+=d?'<h3 class="itemName infoText subtitle">'+d+" - "+m+"</h3>":'<h3 class="itemName infoText subtitle">'+m+"</h3>":o=e.OriginalTitle&&e.OriginalTitle!=e.Name?'<h1 class="itemName infoText parentNameLast withOriginalTitle">'+m+"</h1>"+o:'<h1 class="itemName infoText parentNameLast">'+m+"</h1>"+o,e.OriginalTitle&&e.OriginalTitle!=e.Name&&(o+='<h4 class="itemName infoText originalTitle">'+e.OriginalTitle+"</h4>"),i.innerHTML=o,o.length?i.classList.remove("hide"):i.classList.add("hide")}(g,y.querySelector(".nameContainer"),p.context),k(y,g,L,p.context),b(y,l,g),function(e,t,r,i){if("SeriesTimer"===t.Type){if(i.Policy.EnableLiveTvManagement)return require(["seriesRecordingEditor"],function(i){i.embed(t,r.serverId(),{context:e.querySelector(".seriesRecordingEditor")})}),e.querySelector(".seriesTimerScheduleSection").classList.remove("hide"),I(e,"btnCancelSeriesTimer",!0),void function(e,t,r){t.getLiveTvTimers({UserId:t.getCurrentUserId(),ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Thumb",SortBy:"StartDate",EnableTotalRecordCount:!1,EnableUserData:!1,SeriesTimerId:r,Fields:"ChannelInfo,ChannelImage"}).then(function(t){t.Items.length&&t.Items[0].SeriesTimerId!=r&&(t.Items=[]);var i=function(e){var t="";return t+='<div is="emby-itemscontainer" class="itemsContainer vertical-list" data-contextmenu="false">',(t+=c.getListViewHtml({items:e,enableUserDataButtons:!1,image:!0,imageSource:"channel",showProgramDateTime:!0,showChannel:!1,mediaInfo:!1,action:"none",moreButton:!1,recordButton:!1}))+"</div>"}(t.Items),a=e.querySelector(".seriesTimerSchedule");a.innerHTML=i,h.lazyChildren(a)})}(e,r,t.Id);e.querySelector(".seriesTimerScheduleSection").classList.add("hide"),I(e,"btnCancelSeriesTimer")}else I(e,"btnCancelSeriesTimer")}(y,g,L,v),function(e,t,r,i){"Recording"===t.Type&&i.Policy.EnableLiveTvManagement&&t.TimerId&&"InProgress"===t.Status?I(e,"btnCancelTimer",!0):I(e,"btnCancelTimer")}(y,g,0,v),w(y,g,L,p.context,v);var A=M(y,g);(g.LocalTrailerCount||g.RemoteTrailers&&g.RemoteTrailers.length)&&-1!==S.getSupportedCommands().indexOf("PlayTrailers")?I(y,"btnPlayTrailer",!0):I(y,"btnPlayTrailer"),P(y,g),"Program"!==g.Type||A?I(y,"mainDetailButtons",!0):I(y,"mainDetailButtons"),function(e,t,r,i){if(!e.currentRecordingFields){var a=t.querySelector(".recordingFields");"Program"==r.Type&&i.Policy.EnableLiveTvManagement?require(["recordingFields"],function(t){e.currentRecordingFields=new t({parent:a,programId:r.Id,serverId:r.ServerId}),a.classList.remove("hide")}):(a.classList.add("hide"),a.innerHTML="")}}(l,y,g,v);var C=(g.MediaSources||[]).filter(function(e){return"Grouping"==e.Type});v.Policy.IsAdministrator&&C.length?y.querySelector(".btnSplitVersions").classList.remove("hide"):y.querySelector(".btnSplitVersions").classList.add("hide"),d.getCommands(T(g,v)).length?I(y,"btnMoreCommands",!0):I(y,"btnMoreCommands");var H=y.querySelector("#itemBirthday");if("Person"==g.Type&&g.PremiereDate)try{var x=s.parseISO8601Date(g.PremiereDate,!0).toDateString();H.classList.remove("hide"),H.innerHTML=f.translate("BirthDateValue",x)}catch(e){H.classList.add("hide")}else H.classList.add("hide");var D=y.querySelector("#itemDeathDate");if("Person"==g.Type&&g.EndDate)try{var B=s.parseISO8601Date(g.EndDate,!0).toDateString();D.classList.remove("hide"),D.innerHTML=f.translate("DeathDateValue",B)}catch(e){D.classList.add("hide")}else D.classList.add("hide");var U=y.querySelector("#itemBirthLocation");if("Person"==g.Type&&g.ProductionLocations&&g.ProductionLocations.length){var N='<a is="emby-linkbutton" class="button-link textlink" target="_blank" href="https://maps.google.com/maps?q='+g.ProductionLocations[0]+'">'+g.ProductionLocations[0]+"</a>";U.classList.remove("hide"),U.innerHTML=f.translate("BirthPlaceValue",N)}else U.classList.add("hide");!function(e,t){"Audio"==t.MediaType||"MusicAlbum"==t.Type||"Book"==t.MediaType||"Photo"==t.MediaType?e.querySelector("#peopleHeader").innerHTML=f.translate("HeaderPeople"):e.querySelector("#peopleHeader").innerHTML=f.translate("HeaderCastAndCrew")}(y,g),e.hide(),"Book"===g.Type&&I(y,"btnDownload",!0),require(["autoFocuser"],function(e){e.autoFocus(y)})}function w(t,a,s,l,o){t.querySelector(".collectionItems").innerHTML="","Playlist"==a.Type?(t.querySelector("#childrenCollapsible").classList.remove("hide"),function(e,t){require("scripts/playlistedit".split(","),function(){PlaylistViewer.render(e,t)})}(t,a)):"Studio"==a.Type||"Person"==a.Type||"Genre"==a.Type||"MusicGenre"==a.Type||"MusicArtist"==a.Type?(t.querySelector("#childrenCollapsible").classList.remove("hide"),function(e,t){require("scripts/itembynamedetailpage".split(","),function(){window.ItemsByName.renderItems(e,t)})}(t,a)):a.IsFolder?("BoxSet"==a.Type&&t.querySelector("#childrenCollapsible").classList.add("hide"),function e(t,a){var s,l="ItemCounts,PrimaryImageAspectRatio,BasicSyncInfo,CanDelete,MediaSourceCount",o={ParentId:a.Id,Fields:l};"BoxSet"!==a.Type&&(o.SortBy="SortName");var d=i.getApiClient(a.ServerId),u=d.getCurrentUserId();"Series"==a.Type?s=d.getSeasons(a.Id,{userId:u,Fields:l}):"Season"==a.Type?(l+=",Overview",s=d.getEpisodes(a.SeriesId,{seasonId:a.Id,userId:u,Fields:l})):"MusicArtist"==a.Type&&(o.SortBy="ProductionYear,SortName"),(s=s||d.getItems(d.getCurrentUserId(),o)).then(function(i){var s="",l=!1,o=!1,d=t.querySelector(".childrenItemsContainer");if("MusicAlbum"==a.Type)s=c.getListViewHtml({items:i.Items,smallIcon:!0,showIndex:!0,index:"disc",showIndexNumberLeft:!0,playFromHere:!0,action:"playallfromhere",image:!1,artist:"auto",containerAlbumArtists:a.AlbumArtists}),o=!0;else if("Series"==a.Type)l=D(),s=n.getCardsHtml({items:i.Items,shape:"overflowPortrait",showTitle:!0,centerText:!0,lazy:!0,overlayPlayButton:!0,allowBottomPadding:!l});else if("Season"==a.Type||"Episode"==a.Type){if("Episode"!==a.Type&&(o=!0),l="Episode"==a.Type,i.Items.length<2&&"Episode"===a.Type)return;"Episode"===a.Type?s=n.getCardsHtml({items:i.Items,shape:"overflowBackdrop",showTitle:!0,displayAsSpecial:"Season"==a.Type&&a.IndexNumber,playFromHere:!0,overlayText:!0,lazy:!0,showDetailsMenu:!0,overlayPlayButton:!0,allowBottomPadding:!l,includeParentInfoInTitle:!1}):"Season"===a.Type&&(s=c.getListViewHtml({items:i.Items,showIndexNumber:!1,enableOverview:!0,enablePlayedButton:!r.mobile,infoButton:!r.mobile,imageSize:"large",enableSideMediaInfo:!1,highlight:!1,action:r.desktop?"none":"link",imagePlayButton:!0,includeParentInfoInTitle:!1}))}if("BoxSet"!==a.Type&&t.querySelector("#childrenCollapsible").classList.remove("hide"),l?(d.classList.add("scrollX"),d.classList.add("hiddenScrollX"),d.classList.remove("vertical-wrap"),d.classList.remove("vertical-list")):(d.classList.remove("scrollX"),d.classList.remove("hiddenScrollX"),d.classList.remove("smoothScrollX"),o?(d.classList.add("vertical-list"),d.classList.remove("vertical-wrap")):(d.classList.add("vertical-wrap"),d.classList.remove("vertical-list"))),r.mobile&&d.classList.remove("padded-right"),d.innerHTML=s,h.lazyChildren(d),"BoxSet"==a.Type){var u=[{name:f.translate("HeaderVideos"),mediaType:"Video"},{name:f.translate("HeaderSeries"),type:"Series"},{name:f.translate("HeaderAlbums"),type:"MusicAlbum"},{name:f.translate("HeaderBooks"),type:"Book"}];!function(t,r,i,a){t.querySelector(".collectionItems").classList.remove("hide"),t.querySelector(".collectionItems").innerHTML="";var n,s=_createForOfIteratorHelper(i);try{for(s.s();!(n=s.n()).done;){var l=n.value,o=U(a,l);o.length&&N(t,r,l,o)}}catch(e){s.e(e)}finally{s.f()}var c={name:f.translate("HeaderOtherItems")},d=a.filter(function(e){return!i.filter(function(t){return U([e],t).length>0}).length});d.length&&N(t,r,c,d),a.length||N(t,r,{name:f.translate("HeaderItems")},a);var u,m=t.querySelectorAll(".collectionItemsContainer"),y=function(){e(t,r)},h=_createForOfIteratorHelper(m);try{for(h.s();!(u=h.n()).done;)u.value.notifyRefreshNeeded=y}catch(e){h.e(e)}finally{h.f()}(function(e){for(var t=0,r=e.length;t<r;t++)if(S.canPlay(e[t]))return!0;return!1})(a)||(I(t,"btnPlay",!1),I(t,"btnShuffle",!1)),require(["autoFocuser"],function(e){e.autoFocus(t)})}(t,a,u,i.Items)}}),"Season"==a.Type?t.querySelector("#childrenTitle").innerHTML=f.translate("HeaderEpisodes"):"Series"==a.Type?t.querySelector("#childrenTitle").innerHTML=f.translate("HeaderSeasons"):"MusicAlbum"==a.Type?t.querySelector("#childrenTitle").innerHTML=f.translate("HeaderTracks"):t.querySelector("#childrenTitle").innerHTML=f.translate("HeaderItems"),"MusicAlbum"==a.Type||"Season"==a.Type?(t.querySelector(".childrenSectionHeader").classList.add("hide"),t.querySelector("#childrenCollapsible").classList.add("verticalSection-extrabottompadding")):t.querySelector(".childrenSectionHeader").classList.remove("hide")}(t,a)):t.querySelector("#childrenCollapsible").classList.add("hide"),"Series"==a.Type?(function(t,r){var a=i.getApiClient(r.ServerId);a.getLiveTvPrograms({UserId:a.getCurrentUserId(),HasAired:!1,SortBy:"StartDate",EnableTotalRecordCount:!1,EnableImages:!1,ImageTypeLimit:0,Limit:50,EnableUserData:!1,LibrarySeriesId:r.Id}).then(function(r){r.Items.length?t.querySelector("#seriesScheduleSection").classList.remove("hide"):t.querySelector("#seriesScheduleSection").classList.add("hide"),t.querySelector("#seriesScheduleList").innerHTML=c.getListViewHtml({items:r.Items,enableUserDataButtons:!1,showParentTitle:!1,image:!1,showProgramDateTime:!0,mediaInfo:!1,showTitle:!0,moreButton:!1,action:"programdialog"}),e.hide()})}(t,a),function(e,t,r){var a=e.querySelector(".nextUpSection");"Series"==t.Type?i.getApiClient(t.ServerId).getNextUpEpisodes({SeriesId:t.Id,UserId:r.Id}).then(function(e){e.Items.length?a.classList.remove("hide"):a.classList.add("hide");var r=n.getCardsHtml({items:e.Items,shape:"overflowBackdrop",showTitle:!0,displayAsSpecial:"Season"==t.Type&&t.IndexNumber,overlayText:!1,centerText:!0,overlayPlayButton:!0}),i=a.querySelector(".nextUpItems");i.innerHTML=r,h.lazyChildren(i)}):a.classList.add("hide")}(t,a,o)):t.querySelector(".nextUpSection").classList.add("hide"),E(t,a),a.SpecialFeatureCount&&0!=a.SpecialFeatureCount&&"Series"!=a.Type?(t.querySelector("#specialsCollapsible").classList.remove("hide"),_(t,a,o,6)):t.querySelector("#specialsCollapsible").classList.add("hide"),R(t,a),a.PartCount&&a.PartCount>1?(t.querySelector("#additionalPartsCollapsible").classList.remove("hide"),function(e,t,r){i.getApiClient(t.ServerId).getAdditionalVideoParts(r.Id,t.Id).then(function(t){if(t.Items.length){e.querySelector("#additionalPartsCollapsible").classList.remove("hide");var i=e.querySelector("#additionalPartsContent");i.innerHTML=F(t.Items,r),h.lazyChildren(i)}else e.querySelector("#additionalPartsCollapsible").classList.add("hide")})}(t,a,o)):t.querySelector("#additionalPartsCollapsible").classList.add("hide"),"MusicAlbum"==a.Type?function(e,t,r){i.getApiClient(t.ServerId).getItems(r.Id,{SortBy:"SortName",SortOrder:"Ascending",IncludeItemTypes:"MusicVideo",Recursive:!0,Fields:"PrimaryImageAspectRatio,BasicSyncInfo,CanDelete,MediaSourceCount",AlbumIds:t.Id}).then(function(t){if(t.Items.length){e.querySelector("#musicVideosCollapsible").classList.remove("hide");var i=e.querySelector(".musicVideosContent");i.innerHTML=F(t.Items,r),h.lazyChildren(i)}else e.querySelector("#musicVideosCollapsible").classList.add("hide")})}(t,a,o):t.querySelector("#musicVideosCollapsible").classList.add("hide")}function x(e,t){var r=t.target;e.classList.contains("detail-clamp-text")?(e.classList.remove("detail-clamp-text"),r.innerHTML=f.translate("ShowLess")):(e.classList.add("detail-clamp-text"),r.innerHTML=f.translate("ShowMore"))}function k(e,a,o,d,m){!function(e,t,r){var a=e.querySelector("#similarCollapsible");if(a){if("Movie"!=t.Type&&"Trailer"!=t.Type&&"Series"!=t.Type&&"Program"!=t.Type&&"Recording"!=t.Type&&"MusicAlbum"!=t.Type&&"MusicArtist"!=t.Type&&"Playlist"!=t.Type)return void a.classList.add("hide");a.classList.remove("hide");var s=i.getApiClient(t.ServerId),l={userId:s.getCurrentUserId(),limit:12,fields:"PrimaryImageAspectRatio,UserData,CanDelete"};"MusicAlbum"==t.Type&&t.AlbumArtists&&t.AlbumArtists.length&&(l.ExcludeArtistIds=t.AlbumArtists[0].Id),s.getSimilarItems(t.Id,l).then(function(e){if(e.Items.length){a.classList.remove("hide");var i="";i+=n.getCardsHtml({items:e.Items,shape:"autooverflow",showParentTitle:"MusicAlbum"==t.Type,centerText:!0,showTitle:!0,context:r,lazy:!0,showDetailsMenu:!0,coverImage:"MusicAlbum"==t.Type||"MusicArtist"==t.Type,overlayPlayButton:!0,overlayText:!1,showYear:"Movie"===t.Type||"Trailer"===t.Type||"Series"===t.Type});var s=a.querySelector(".similarContent");s.innerHTML=i,h.lazyChildren(s)}else a.classList.add("hide")})}}(e,a,d),function(e,t,r){var i=e.querySelector(".moreFromSeasonSection");if(i){if("Episode"!==t.Type||!t.SeasonId||!t.SeriesId)return void i.classList.add("hide");var a=r.getCurrentUserId();r.getEpisodes(t.SeriesId,{SeasonId:t.SeasonId,UserId:a,Fields:"ItemCounts,PrimaryImageAspectRatio,BasicSyncInfo,CanDelete,MediaSourceCount"}).then(function(e){if(e.Items.length<2)i.classList.add("hide");else{i.classList.remove("hide"),i.querySelector("h2").innerHTML=f.translate("MoreFromValue",t.SeasonName);var r=i.querySelector(".itemsContainer");n.buildCards(e.Items,{parentContainer:i,itemsContainer:r,shape:"autooverflow",sectionTitleTagName:"h2",scalable:!0,showTitle:!0,overlayText:!1,centerText:!0,includeParentInfoInTitle:!1,allowBottomPadding:!1});var a=r.querySelector('.card[data-id="'+t.Id+'"]');a&&setTimeout(function(){i.querySelector(".emby-scroller").toStart(a.previousSibling||a,!0)},100)}})}}(e,a,o),function(e,t,r){var i=e.querySelector(".moreFromArtistSection");if(i){if("MusicArtist"===t.Type){if(!r.isMinServerVersion("3.4.1.19"))return void i.classList.add("hide")}else if("MusicAlbum"!==t.Type||!t.AlbumArtists||!t.AlbumArtists.length)return void i.classList.add("hide");var a={IncludeItemTypes:"MusicAlbum",Recursive:!0,ExcludeItemIds:t.Id,SortBy:"ProductionYear,SortName",SortOrder:"Descending"};"MusicArtist"===t.Type?a.ContributingArtistIds=t.Id:r.isMinServerVersion("3.4.1.18")?a.AlbumArtistIds=t.AlbumArtists[0].Id:a.ArtistIds=t.AlbumArtists[0].Id,r.getItems(r.getCurrentUserId(),a).then(function(e){e.Items.length?(i.classList.remove("hide"),"MusicArtist"===t.Type?i.querySelector("h2").innerHTML=f.translate("HeaderAppearsOn"):i.querySelector("h2").innerHTML=f.translate("MoreFromValue",t.AlbumArtists[0].Name),n.buildCards(e.Items,{parentContainer:i,itemsContainer:i.querySelector(".itemsContainer"),shape:"autooverflow",sectionTitleTagName:"h2",scalable:!0,coverImage:"MusicArtist"===t.Type||"MusicAlbum"===t.Type,showTitle:!0,showParentTitle:!1,centerText:!0,overlayText:!1,overlayPlayButton:!0,showYear:!0})):i.classList.add("hide")})}}(e,a,o),function(e,r,i){var a=(r.People||[]).filter(function(e){return"Director"===e.Type}),n=a.map(function(e){return'<a style="color:inherit;" class="button-link" is="emby-linkbutton" href="'+t.getRouteUrl({Name:e.Name,Type:"Person",ServerId:r.ServerId,Id:e.Id},{context:i})+'">'+e.Name+"</a>"}).join(", ");e.querySelector(".directorsLabel").innerHTML=f.translate(a.length>1?"Directors":"Director"),e.querySelector(".directors").innerHTML=n;var s=e.querySelector(".directorsGroup");a.length?s.classList.remove("hide"):s.classList.add("hide")}(e,a,d),function(e,r,i){var a=(r.People||[]).filter(function(e){return"Writer"===e.Type}),n=a.map(function(e){return'<a style="color:inherit;" class="button-link" is="emby-linkbutton" href="'+t.getRouteUrl({Name:e.Name,Type:"Person",ServerId:r.ServerId,Id:e.Id},{context:i})+'">'+e.Name+"</a>"}).join(", ");e.querySelector(".writersLabel").innerHTML=f.translate(a.length>1?"Writers":"Writer"),e.querySelector(".writers").innerHTML=n;var s=e.querySelector(".writersGroup");a.length?s.classList.remove("hide"):s.classList.add("hide")}(e,a,d),function(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:B(r),a=r.GenreItems||[],n="music"===i?"MusicGenre":"Genre",s=a.map(function(e){return'<a style="color:inherit;" class="button-link" is="emby-linkbutton" href="'+t.getRouteUrl({Name:e.Name,Type:n,ServerId:r.ServerId,Id:e.Id},{context:i})+'">'+e.Name+"</a>"}).join(", ");e.querySelector(".genresLabel").innerHTML=f.translate(a.length>1?"Genres":"Genre"),e.querySelector(".genres").innerHTML=s;var l=e.querySelector(".genresGroup");a.length?l.classList.remove("hide"):l.classList.add("hide")}(e,a,d),function(e,t,r){"TvChannel"===r.Type&&(e.querySelector(".programGuideSection").classList.remove("hide"),t.getLiveTvPrograms({ChannelIds:r.Id,UserId:t.getCurrentUserId(),HasAired:!1,SortBy:"StartDate",EnableTotalRecordCount:!1,EnableImages:!1,ImageTypeLimit:0,EnableUserData:!1}).then(function(t){!function(e,t){for(var r="",i=[],a=null,n=0,l=t.Items.length;n<l;n++){var o=t.Items[n],d=s.parseISO8601Date(o.StartDate);a&&a.toDateString()===d.toDateString()||(i.length&&(r+='<div class="verticalSection verticalDetailSection">',r+='<h2 class="sectionTitle padded-left">'+s.toLocaleDateString(a,{weekday:"long",month:"long",day:"numeric"})+"</h2>",r+='<div is="emby-itemscontainer" class="vertical-list padded-left padded-right">'+c.getListViewHtml({items:i,enableUserDataButtons:!1,showParentTitle:!0,image:!1,showProgramTime:!0,mediaInfo:!1,parentTitleWithTitle:!0})+"</div></div>"),a=d,i=[]),i.push(o)}i.length&&(r+='<div class="verticalSection verticalDetailSection">',r+='<h2 class="sectionTitle padded-left">'+s.toLocaleDateString(a,{weekday:"long",month:"long",day:"numeric"})+"</h2>",r+='<div is="emby-itemscontainer" class="vertical-list padded-left padded-right">'+c.getListViewHtml({items:i,enableUserDataButtons:!1,showParentTitle:!0,image:!1,showProgramTime:!0,mediaInfo:!1,parentTitleWithTitle:!0})+"</div></div>"),e.querySelector(".programGuide").innerHTML=r}(e,t)}))}(e,o,a),function(e,t){var r=e.querySelector(".tagline");t.Taglines&&t.Taglines.length?(r.classList.remove("hide"),r.innerHTML=t.Taglines[0]):r.classList.add("hide")}(e,a),function(e,t){var r,i=_createForOfIteratorHelper(e.querySelectorAll(".overview"));try{for(i.s();!(r=i.n()).done;){var a=r.value,n=t.Overview||"";if(n){a.innerHTML=n,a.classList.remove("hide"),a.classList.add("detail-clamp-text");var s=a.parentElement.querySelector(".overview-expand");Math.abs(a.scrollHeight-a.offsetHeight)>2?s.classList.remove("hide"):s.classList.add("hide"),s.addEventListener("click",x.bind(null,a));var l,o=_createForOfIteratorHelper(a.querySelectorAll("a"));try{for(o.s();!(l=o.n()).done;)l.value.setAttribute("target","_blank")}catch(e){o.e(e)}finally{o.f()}}else a.innerHTML="",a.classList.add("hide")}}catch(e){i.e(e)}finally{i.f()}}(e,a),function(e,t){var r,i=_createForOfIteratorHelper(e.querySelectorAll(".itemMiscInfo-primary"));try{for(i.s();!(r=i.n()).done;){var a=r.value;l.fillPrimaryMediaInfo(a,t,{interactive:!0,episodeTitle:!1,subtitles:!1}),a.innerHTML&&"SeriesTimer"!==t.Type?a.classList.remove("hide"):a.classList.add("hide")}}catch(e){i.e(e)}finally{i.f()}var n,s=_createForOfIteratorHelper(e.querySelectorAll(".itemMiscInfo-secondary"));try{for(s.s();!(n=s.n()).done;){var o=n.value;l.fillSecondaryMediaInfo(o,t,{interactive:!0}),o.innerHTML&&"SeriesTimer"!==t.Type?o.classList.remove("hide"):o.classList.add("hide")}}catch(e){s.e(e)}finally{s.f()}}(e,a),function(e,t){var r,i,a=e.querySelectorAll(".btnPlaystate");for(r=0,i=a.length;r<i;r++){var n=a[r];u.canMarkPlayed(t)?(n.classList.remove("hide"),n.setItem(t)):(n.classList.add("hide"),n.setItem(null))}var s=e.querySelectorAll(".btnUserRating");for(r=0,i=s.length;r<i;r++){var l=s[r];u.canRate(t)?(l.classList.remove("hide"),l.setItem(t)):(l.classList.add("hide"),l.setItem(null))}}(e,a),function(e,t){var i=e.querySelector(".itemExternalLinks"),a=[];if(!r.tv&&t.HomePageUrl&&a.push('<a is="emby-linkbutton" class="button-link" href="'.concat(t.HomePageUrl,'" target="_blank">').concat(f.translate("ButtonWebsite"),"</a>")),t.ExternalUrls){var n,s=_createForOfIteratorHelper(t.ExternalUrls);try{for(s.s();!(n=s.n()).done;){var l=n.value;a.push('<a is="emby-linkbutton" class="button-link" href="'.concat(l.Url,'" target="_blank">').concat(l.Name,"</a>"))}}catch(e){s.e(e)}finally{s.f()}}var o=[];a.length&&o.push(a.join(", ")),i.innerHTML=o.join(", "),o.length?i.classList.remove("hide"):i.classList.add("hide")}(e,a),function(e,t){var r=e.querySelector(".itemTags"),i=[],a=t.Tags||[];"Program"===t.Type&&(a=[]);for(var n=0,s=a.length;n<s;n++)i.push(a[n]);i.length?(r.innerHTML=f.translate("TagsValue",i.join(", ")),r.classList.remove("hide")):(r.innerHTML="",r.classList.add("hide"))}(e,a),function(e,r,i){var a=e.querySelector("#seriesAirTime");if("Series"==r.Type){var n="";if(r.AirDays&&r.AirDays.length&&(7==r.AirDays.length?n+="daily":n+=r.AirDays.map(function(e){return e+"s"}).join(",")),r.AirTime&&(n+=" at "+r.AirTime),r.Studios.length)if(i)n+=" on "+r.Studios[0].Name;else{var s=B(r);n+=' on <a class="textlink button-link" is="emby-linkbutton" href="'+t.getRouteUrl(r.Studios[0],{context:s,itemType:"Studio",serverId:r.ServerId})+'">'+r.Studios[0].Name+"</a>"}n?(n=("Ended"==r.Status?"Aired ":"Airs ")+n,a.innerHTML=n,a.classList.remove("hide")):a.classList.add("hide")}else a.classList.add("hide")}(e,a,m)}function D(){return g.mobile&&screen.availWidth<=1e3}function B(e){return"Movie"===e.Type||"BoxSet"===e.Type?"movies":"Series"===e.Type||"Season"===e.Type||"Episode"===e.Type?"tvshows":"MusicArtist"===e.Type||"MusicAlbum"===e.Type||"Audio"===e.Type||"AudioBook"===e.Type?"music":"Program"===e.Type?"livetv":null}function U(e,t){return e.filter(function(e){return t.mediaType?e.MediaType==t.mediaType:e.Type==t.type})}function N(e,t,r,i){var a="";a+='<div class="verticalSection">',a+='<div class="sectionTitleContainer sectionTitleContainer-cards padded-left">',a+='<h2 class="sectionTitle sectionTitle-cards">',a+="<span>"+r.name+"</span>",a+="</h2>",a+='<button class="btnAddToCollection sectionTitleButton" type="button" is="paper-icon-button-light" style="margin-left:1em;"><span class="material-icons add"></span></button>',a+="</div>",a+='<div is="emby-itemscontainer" class="itemsContainer collectionItemsContainer vertical-wrap padded-left padded-right">';var s,l="MusicAlbum"==r.type?(null==(s=!1)&&(s=D()),s?"overflowSquare":"square"):function(e){return null==e&&(e=D()),e?"overflowPortrait":"portrait"}(!1);a+=n.getCardsHtml({items:i,shape:l,showTitle:!0,showYear:"Video"===r.mediaType||"Series"===r.type,centerText:!0,lazy:!0,showDetailsMenu:!0,overlayMoreButton:!0,showAddToCollection:!1,showRemoveFromCollection:!0,collectionId:t.Id}),a+="</div>",a+="</div>";var o=e.querySelector(".collectionItems");o.insertAdjacentHTML("beforeend",a),h.lazyChildren(o),o.querySelector(".btnAddToCollection").addEventListener("click",function(){require(["alert"],function(e){e({text:f.translate("AddItemToCollectionHelp"),html:f.translate("AddItemToCollectionHelp")+'<br/><br/><a is="emby-linkbutton" class="button-link" target="_blank" href="https://web.archive.org/web/20181216120305/https://github.com/MediaBrowser/Wiki/wiki/Collections">'+f.translate("ButtonLearnMore")+"</a>"})})})}function E(e,t){var r=t.BackdropImageTags||[],i=e.querySelector("#scenesCollapsible");if(r)for(var a=0,n=r.length;a<n;a++)i.innerHTML+='<div is="emby-itemscontainer" class="itemsContainer vertical-wrap padded-left padded-right"><a href="/emby/items/'+t.Id+"/Images/Primary/"+a+'" target="_blank"> <img src="/emby/items/'+t.Id+"/Images/Primary/"+a+'?maxWidth=150&quality=90"hspace="20" onerror="this.style.display=\'none\'"/></a><a href="/emby/Items/'+t.Id+"/Images/Art/"+a+'" target="_blank"> <img src="/emby/Items/'+t.Id+"/Images/Art/"+a+'?maxWidth=150&quality=90"hspace="20" onerror="this.style.display=\'none\'"/></a><a href="/emby/Items/'+t.Id+"/Images/Logo/"+a+'" target="_blank"> <img src="/emby/Items/'+t.Id+"/Images/Logo/"+a+'?maxWidth=150&quality=90"hspace="20" onerror="this.style.display=\'none\'"/></a><a href="/emby/Items/'+t.Id+"/Images/Disc/"+a+'" target="_blank"><img src="/emby/Items/'+t.Id+"/Images/Disc/"+a+'?maxWidth=150&quality=90"hspace="35" onerror="this.style.display=\'none\'"/></a><a href="/emby/Items/'+t.Id+"/Images/Backdrop/"+a+'" target="_blank"><img src="/emby/Items/'+t.Id+"/Images/Backdrop/"+a+'?maxWidth=150&quality=90"hspace="35" onerror="this.style.display=\'none\'"/></a><a href="/emby/Items/'+t.Id+"/Images/Banner/"+a+'" target="_blank"><img src="/emby/Items/'+t.Id+"/Images/Banner/"+a+'?maxWidth=150&quality=90"hspace="35" onerror="this.style.display=\'none\'"/></a><a href="/emby/Items/'+t.Id+"/Images/Box/"+a+'" target="_blank"><img src="/emby/Items/'+t.Id+"/Images/Box/"+a+'?maxWidth=150&quality=90"hspace="35" onerror="this.style.display=\'none\'"/></a><a href="/emby/Items/'+t.Id+"/Images/Thumb/"+a+'" target="_blank"><img src="/emby/Items/'+t.Id+"/Images/Thumb/"+a+'?maxWidth=150&quality=90"hspace="35" onerror="this.style.display=\'none\'"/></a></div>'}function F(e,t,r,i){var a=n.getCardsHtml({items:e,shape:"auto",showTitle:!0,action:"play",overlayText:!1,centerText:!0,showRuntime:!0});return r&&e.length>r&&(a+='<p style="margin: 0;padding-left:5px;"><button is="emby-button" type="button" class="raised more '+i+'">'+f.translate("ButtonMore")+"</button></p>"),a}function _(e,t,r,a){i.getApiClient(t.ServerId).getSpecialFeatures(r.Id,t.Id).then(function(t){var r=e.querySelector("#specialsContent");r.innerHTML=F(t,0,a,"moreSpecials"),h.lazyChildren(r)})}function R(e,t){var r=(t.People||[]).filter(function(e){return"Actor"===e.Type});if(r.length){e.querySelector("#castCollapsible").classList.remove("hide");var i=e.querySelector("#castContent");require(["peoplecardbuilder"],function(e){e.buildPeopleCards(r,{itemsContainer:i,coverImage:!0,serverId:t.ServerId,shape:"overflowPortrait",imageBlurhashes:t.ImageBlurHashes})})}else e.querySelector("#castCollapsible").classList.add("hide")}function O(e,t,r,i){var a,n=_createForOfIteratorHelper(e.querySelectorAll(t));try{for(n.s();!(a=n.n()).done;)a.value.addEventListener(r,i)}catch(e){n.e(e)}finally{n.f()}}function V(e){return e.preventDefault(),!1}return window.ItemDetailPage=new function(){this.setInitialCollapsibleState=w,this.renderDetails=k,this.renderCast=R},function(r,a){function n(t,r,a){e.show();var n=a.serverId?i.getApiClient(a.serverId):ApiClient;Promise.all([function(e,t){var r=t.id;if(r)return e.getItem(e.getCurrentUserId(),r);if(t.seriesTimerId)return e.getLiveTvSeriesTimer(t.seriesTimerId);if(t.genre)return e.getGenre(t.genre,e.getCurrentUserId());if(t.musicgenre)return e.getMusicGenre(t.musicgenre,e.getCurrentUserId());if(t.musicartist)return e.getArtist(t.musicartist,e.getCurrentUserId());throw new Error("Invalid request")}(n,a),n.getCurrentUser()]).then(function(e){var i=_slicedToArray(e,2),n=i[0],s=i[1];c=n,H(t,r,a,n,s)}).catch(function(e){console.error("failed to get item or current user: ",e)})}function s(){!function(e,t){var a=c;if("Program"!==a.Type)!function(e,t){var i=function(e){var t=r.querySelector(".selectAudio").value||null;return{startPositionTicks:e,mediaSourceId:r.querySelector(".selectSource").value,audioStreamIndex:t,subtitleStreamIndex:r.querySelector(".selectSubtitles").value}}(t);i.items=[e],S.play(i)}(a,a.UserData&&"resume"===t?a.UserData.PlaybackPositionTicks:0);else{var n=i.getApiClient(a.ServerId);n.getLiveTvChannel(a.ChannelId,n.getCurrentUserId()).then(function(e){S.play({items:[e]})})}}(0,this.getAttribute("data-mode"))}function l(){b(r,u,c),P(r,c)}function o(e,t){var i,a=t;if("UserDataChanged"===a.MessageType&&c&&a.Data.UserId==h.getCurrentUserId()){var n=c.UserData.Key,s=a.Data.UserDataList.filter(function(e){return e.Key==n})[0];s&&(c.UserData=s,M(r,c),i=c,function(e,t){e.querySelector(".detailImageProgressContainer").innerHTML=y.getProgressBarHtml(t)}(r.querySelector(".detailImageContainer"),i))}}var c,u=this,h=a.serverId?i.getApiClient(a.serverId):ApiClient;r.querySelectorAll(".btnPlay"),O(r,".btnPlay","click",s),O(r,".btnResume","click",s),O(r,".btnInstantMix","click",function(){S.instantMix(c)}),O(r,".btnShuffle","click",function(){S.shuffle(c)}),O(r,".btnPlayTrailer","click",function(){S.playTrailers(c)}),O(r,".btnCancelSeriesTimer","click",function(){require(["recordingHelper"],function(e){e.cancelSeriesTimerWithConfirmation(c.Id,c.ServerId).then(function(){Dashboard.navigate("livetv.html")})})}),O(r,".btnCancelTimer","click",function(){require(["recordingHelper"],function(e){e.cancelTimer(i.getApiClient(c.ServerId),c.TimerId).then(function(){n(u,r,a)})})}),O(r,".btnDownload","click",function(){require(["fileDownloader"],function(e){var t=h.getItemDownloadUrl(c.Id);e.download([{url:t,itemId:c.Id,serverId:c.serverId}])})}),r.querySelector(".trackSelections").addEventListener("submit",V),r.querySelector(".btnSplitVersions").addEventListener("click",function(){!function(t,r,i,a){require(["confirm"],function(s){s("Are you sure you wish to split the media sources into separate items?","Split Media Apart").then(function(){e.show(),i.ajax({type:"DELETE",url:i.getUrl("Videos/"+a.id+"/AlternateSources")}).then(function(){e.hide(),n(t,r,a)})})})}(u,r,h,a)}),O(r,".btnMoreCommands","click",function(){var e=this;h.getCurrentUser().then(function(i){d.show(T(c,i,e)).then(function(e){e.deleted?t.goHome():e.updated&&n(u,r,a)})})}),r.querySelector(".selectSource").addEventListener("change",function(){L(r,u._currentPlaybackMediaSources),A(r,u._currentPlaybackMediaSources),C(r,u._currentPlaybackMediaSources)}),r.addEventListener("click",function(e){m.parentWithClass(e.target,"moreScenes")?E(r,c):m.parentWithClass(e.target,"morePeople")?R(r,c):m.parentWithClass(e.target,"moreSpecials")&&h.getCurrentUser().then(function(e){_(r,c,e)})}),r.querySelector(".detailImageContainer").addEventListener("click",function(e){m.parentWithClass(e.target,"itemDetailGalleryLink")&&new Promise(function(e,t){require(["imageEditor"],function(r){r.show({itemId:c.Id,serverId:c.ServerId}).then(e,t)})}).then(function(){n(u,r,a)})}),r.addEventListener("viewshow",function(e){p.setTransparentMenu(!0),e.detail.isRestored?c&&(Emby.Page.setTitle(""),b(this,u,c,!0)):n(u,this,a),v.on(h,"message",o),v.on(S,"playerchange",l)}),r.addEventListener("viewbeforehide",function(){v.off(h,"message",o),v.off(S,"playerchange",l),p.setTransparentMenu(!1)}),r.addEventListener("viewdestroy",function(){c=null,u._currentPlaybackMediaSources=null,u.currentRecordingFields=null})}});